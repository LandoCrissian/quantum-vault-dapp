<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>Quantum Vault ‚Äì Lounge</title>
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@500;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Space Grotesk', sans-serif; }
    body {
      background: #000;
      color: #fff;
      overflow-x: hidden;
      padding: 16px;
      text-align: center;
    }
    .container {
      max-width: 600px;
      margin: auto;
      padding-bottom: 100px;
    }
    .section {
      background: rgba(255,255,255,0.03);
      border: 1px solid rgba(255,255,255,0.08);
      border-radius: 18px;
      padding: 24px;
      margin-bottom: 20px;
      backdrop-filter: blur(14px);
    }
    .title {
      font-size: 20px;
      color: #00ffe1;
      margin-bottom: 12px;
    }
    .wallet {
      font-size: 13px;
      color: #aaa;
      margin-bottom: 8px;
      word-break: break-word;
    }
    .badge {
      display: inline-block;
      background: #00ffe1;
      color: #000;
      padding: 4px 10px;
      font-size: 12px;
      border-radius: 6px;
      margin: 6px 4px;
      font-weight: bold;
    }
    .carousel {
      display: flex;
      overflow-x: auto;
      gap: 12px;
      scroll-snap-type: x mandatory;
      padding: 10px 0;
    }
    .carousel::-webkit-scrollbar { display: none; }
    .carousel-item {
      flex: 0 0 auto;
      scroll-snap-align: start;
      background: #111;
      border: 1px solid rgba(255,255,255,0.08);
      border-radius: 14px;
      padding: 14px;
      width: 160px;
      text-align: center;
    }
    .carousel-item img {
      width: 50px;
      height: 50px;
      object-fit: contain;
      margin-bottom: 8px;
    }
    .carousel-item p {
      font-size: 13px;
      color: #ccc;
    }
    .share-btn {
      margin-top: 12px;
      background: #111;
      color: #00ffe1;
      padding: 8px 14px;
      border: 1px solid #00ffe140;
      border-radius: 10px;
      font-size: 13px;
      cursor: pointer;
    }
    .share-btn:hover {
      background: #181818;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="section">
      <div class="title">Welcome to the Quantum Lounge</div>
      <div id="walletDisplay" class="wallet">Connecting...</div>
      <div class="badge" id="balanceBadge">Y2K Winnings: 0</div>
    </div>

    <div class="section">
      <div class="title">MVP Spotlight</div>
      <div id="mvpUser">@mvpUser</div>
      <div class="wallet" id="mvpEarnings">0 Y2K Earned</div>
    </div>

    <div class="section">
      <div class="title">New Players (Last 48h)</div>
      <div id="newPlayers">Loading...</div>
    </div>

    <div class="section">
      <div class="title">Partner Projects</div>
      <div class="carousel" id="partnerCarousel">
        <!-- Partner logos will be inserted here -->
      </div>
    </div>

    <div class="section">
      <div class="title">Share Your Profile</div>
      <button class="share-btn" onclick="shareToX()">Post to ùïè</button>
    </div>

        <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-app.js";
      import {
        getFirestore, doc, getDoc, collection, getDocs, query, orderBy, limit, where
      } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-firestore.js";

      const firebaseConfig = {
        apiKey: "AIzaSyCJwqDFZtf1PkZwAalOaf2_7eWtej5HIfA",
        authDomain: "y2k-arcade.firebaseapp.com",
        projectId: "y2k-arcade",
        storageBucket: "y2k-arcade.appspot.com",
        messagingSenderId: "1063043176357",
        appId: "1:1063043176357:web:20bc22e9cbf269ff40fa4c"
      };

      const app = initializeApp(firebaseConfig);
      const db = getFirestore(app);

      let currentWallet = "";

      async function connectWalletAndLoadData() {
        if (!window.ethereum) {
          alert("Please install MetaMask");
          return;
        }

        const provider = new ethers.providers.Web3Provider(window.ethereum);
        await provider.send("eth_requestAccounts", []);
        const signer = provider.getSigner();
        const address = await signer.getAddress();
        currentWallet = address.toLowerCase();

        document.getElementById("walletDisplay").textContent =
          currentWallet.slice(0, 6) + "..." + currentWallet.slice(-4);

        const docRef = doc(db, "users", currentWallet);
        const snap = await getDoc(docRef);
        const y2k = snap.exists() ? (snap.data().earnings || 0) : 0;

        document.getElementById("balanceBadge").textContent = `Y2K Winnings: ${y2k}`;
      }

      async function loadMVP() {
        const usersRef = collection(db, "users");
        const topEarnerQuery = query(usersRef, orderBy("earnings", "desc"), limit(1));
        const topSnap = await getDocs(topEarnerQuery);
        if (!topSnap.empty) {
          const top = topSnap.docs[0].data();
          const name = top.username || "anon";
          const earn = top.earnings || 0;
          document.getElementById("mvpUser").textContent = "@" + name;
          document.getElementById("mvpEarnings").textContent = earn + " Y2K Earned";
        }
      }

      async function loadNewPlayers() {
        const now = Date.now();
        const cutoff = now - 48 * 60 * 60 * 1000;

        const q = query(collection(db, "users"), where("createdAt", ">", cutoff));
        const snap = await getDocs(q);

        const container = document.getElementById("newPlayers");
        if (snap.empty) {
          container.textContent = "No new users yet.";
          return;
        }

        container.innerHTML = "";
        snap.forEach(doc => {
          const data = doc.data();
          const name = data.username || "anon";
          container.innerHTML += `<div class="badge">@${name}</div>`;
        });
      }

      async function loadPartners() {
        const partners = [
          { name: "DOJO", logo: "https://i.imgur.com/CUZcb5O.png", link: "https://twitter.com/CRODOJO" },
          { name: "CroFighter", logo: "https://i.imgur.com/7gNV9od.png", link: "https://twitter.com/crofighter" },
          { name: "Cards of Cronos", logo: "https://i.imgur.com/o1bHvXN.png", link: "https://twitter.com/CardsofCronos" },
        ];

        const container = document.getElementById("partnerCarousel");
        partners.forEach(partner => {
          const el = document.createElement("div");
          el.className = "carousel-item";
          el.innerHTML = `
            <a href="${partner.link}" target="_blank">
              <img src="${partner.logo}" alt="${partner.name}" />
              <p>${partner.name}</p>
            </a>
          `;
          container.appendChild(el);
        });
      }

      connectWalletAndLoadData();
      loadMVP();
      loadNewPlayers();
      loadPartners();

                function shareToX() {
        const messages = [
          "Just stepped into the Quantum Vault ‚Äî where legends are minted. #CROFAM #Puushfuncronos",
          "This ain‚Äôt your average DApp. Welcome to the gambling multiverse. #CROFAM #Puushfuncronos",
          "Built different. Vaulted forever. #QuantumVault #CROFAM #Puushfuncronos",
          "What happens in the Vault... gets burned in Y2K. #CROFAM #Puushfuncronos",
          "Fresh from the forge ‚Äî my Quantum profile just dropped. #CROFAM #Puushfuncronos",
          "Stacking wins and spotlight. Welcome to the Vault. #CROFAM #Puushfuncronos",
          "The vault ain't just for coins ‚Äî it's for history. #CROFAM #Puushfuncronos",
          "Risk is the new flex. Step inside. #QuantumLounge #CROFAM #Puushfuncronos",
          "My Quantum badge is live. What‚Äôs yours look like? #CROFAM #Puushfuncronos",
          "I came, I saw, I burned tokens. Welcome to the vault. #CROFAM #Puushfuncronos"
        ];

        const msg = encodeURIComponent(messages[Math.floor(Math.random() * messages.length)]);
        const url = encodeURIComponent("https://quantum-vault-y2kxroast.netlify.app/");
        window.open(`https://twitter.com/intent/tweet?text=${msg}&url=${url}`, "_blank");
      }

      document.getElementById("shareBtn").addEventListener("click", shareToX);
    </script>
  </body>
</html>
